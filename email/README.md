Email
=====

**Mastodon** uses email to get in touch with an account holder for different purposes. Mastodon uses outbound email only and does not process any inbound email. Instance administrators can also avoid using email altogether by [manually confirming users](https://github.com/tootsuite/documentation/blob/master/Running-Mastodon/Administration-guide.md#confirming-users-manually) themselves.

This document highlights what emails are used for and where to change email configuration. This document also describes the high-level architecture of how email interfaces with Mastodon, Rails and the OS.
 
### What is email used for in Mastodon?
By default, email is sent to confirm new user accounts. Users can also choose to receive interaction notifications via email. Finally password reset and password reset confirmation is done via email.
- [Emails in the signup process](diagrams/README.md#sign-up-process)
- [Emails and notification](diagrams/README.md#notification-process)
- [Emails during password reset](diagrams/README.md#password-reset-process)

### How do I configure email in Mastodon ?
By default, Mastodon uses the SMTP protocol to send emails. In most cases, you will point Mastodon to an SMTP server that will receive emails from Mastodon and deliver them to the user's email provider on your behalf.
- [Using Mastodon without email](configuration/README.md#without_emails)
- [Understanding SMTP parameters:](configuration/README.md#smtp_parameters)
- [Configure an SMTP provider: mailgun example](configuration/README.md#mailgun_example)
- [SMTP best practice](configuration/README.md#smtp_best_practice)
- [Configure a sendmail compatible relay](configuration/README.md#sendmail_example)
- [Best practice for email](configuration/README.md#email_best_practice)

### Troubleshooting
Toubleshooting why a user isn't getting email is complicated. Emails are generated by the rails app, stored in redis and sent by a sidekiq worker. Actionmailer is used to send the email and openssl is used if TLS is enabled to communicate with your SMTP provider. 
The provider reveiving Mastodon emails will likely do checks to understand if your emails are legitimate or not.
- [Understanding the components involved in Mastodon](troubleshooting/README.md#email_workflow)
- [Troubleshooting emails in mastodon](troubleshooting/README.md#emails_inside_mastodon)
- [Troubleshooting emails outside of mastodon](troubleshooting/README.md#emails_outside_mastodon)
